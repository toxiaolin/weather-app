<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>æ˜Ÿæ²™èŒå¨ƒ Â· æ°”è´¨å¤§èµ Â· ä¸‰å¯ç©</title>
<style>
  /* ================= æ ¸å¿ƒæš—é»‘ä¸»é¢˜å˜é‡ ================= */
  :root {
    --bg-dark: #13142B;
    --bg-card: rgba(255, 255, 255, 0.06);
    --border-glass: rgba(255, 255, 255, 0.12);
    --neon-purple: #B258FF;
    --text-main: #FFFFFF;
    --text-sub: #8E93A8;
    
    --icon-purple: linear-gradient(135deg, #A855F7 0%, #7E22CE 100%);
    --icon-pink: linear-gradient(135deg, #F43F5E 0%, #BE123C 100%);
    --icon-blue: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, sans-serif; -webkit-tap-highlight-color: transparent; }
  
  body {
    background: var(--bg-dark);
    color: var(--text-main);
    padding-bottom: 20px; 
    overflow-x: hidden;
    background-image: radial-gradient(circle at 50% -20%, #2A2155 0%, var(--bg-dark) 60%);
    min-height: 100vh;
  }

  /* ================= é¡¶éƒ¨å¯¼èˆªæ¡ ================= */
  .top-bar {
    display: flex; justify-content: space-between; align-items: center;
    padding: 20px; width: 100%;
  }
  .brand { display: flex; align-items: center; font-weight: 900; font-size: 16px; letter-spacing: 1px;}
  .brand-icon { 
    width: 32px; height: 32px; background: linear-gradient(135deg, #f472b6, #d946ef); 
    border-radius: 10px; margin-right: 10px; display: flex; justify-content: center; align-items: center; font-size:18px;
  }
  .share-btn {
    width: 36px; height: 36px; background: rgba(255,255,255,0.1); border-radius: 50%;
    display: flex; justify-content: center; align-items: center; font-size: 16px; cursor: pointer;
  }

  /* ================= é¡µé¢åˆ‡æ¢åŠ¨ç”» ================= */
  .page { display: none; padding: 0 20px; flex-direction: column; align-items: center; width: 100%; }
  .page.active { display: flex; animation: fadeIn 0.4s ease forwards; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

  /* ================= éœ“è™¹æ–‡å­—ç‰¹æ•ˆ ================= */
  .neon-title { 
    font-size: 44px; font-weight: 900; text-align: center; margin-top: 2vh; margin-bottom: 15px; line-height: 1.2;
    color: #FFFFFF;
    text-shadow: 0 0 10px rgba(178, 88, 255, 0.8), 
                 0 0 20px rgba(178, 88, 255, 0.5), 
                 0 0 40px rgba(178, 88, 255, 0.3);
  }
  .subtitle { font-size: 14px; color: var(--text-sub); margin-bottom: 40px; text-align: center; letter-spacing: 2px;}

  /* ================= ç»ç’ƒè´¨æ„Ÿèœå•å¡ç‰‡ ================= */
  .menu-card {
    background: var(--bg-card);
    border: 1px solid var(--border-glass);
    border-radius: 24px; padding: 20px; width: 100%;
    display: flex; align-items: center; margin-bottom: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
    transition: all 0.2s ease; cursor: pointer;
  }
  .menu-card:active { transform: scale(0.96); background: rgba(255, 255, 255, 0.09); }
  
  .menu-icon {
    width: 65px; height: 65px; border-radius: 18px; display: flex; justify-content: center; align-items: center;
    font-size: 30px; margin-right: 18px; color: #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }
  .menu-text { flex: 1; }
  .menu-text h3 { font-size: 20px; font-weight: bold; margin-bottom: 5px; color: #fff; }
  .menu-text p { font-size: 12px; color: var(--text-sub); line-height: 1.4; }
  .menu-arrow { width: 24px; height: 24px; color: #5B607A; display: flex; justify-content: center; align-items: center; }

  /* ================= åº•éƒ¨æ ‡ç­¾ ================= */
  .footer-info { margin-top: 4vh; text-align: center; width: 100%; padding-bottom: 30px;}
  .footer-time { font-size: 12px; color: #5B607A; margin-bottom: 12px; }
  .tags { display: flex; justify-content: center; gap: 10px; }
  .tag { border: 1px solid #32364B; color: #5B607A; padding: 4px 12px; border-radius: 6px; font-size: 12px; }

  /* ================= é€šç”¨å†…é¡µ UI ================= */
  .inner-card {
    background: var(--bg-card); border: 1px solid var(--border-glass); border-radius: 20px;
    padding: 25px 20px; width: 100%; margin-bottom: 20px; backdrop-filter: blur(10px);
  }
  .btn {
    background: var(--icon-purple); color: #fff; border: none; padding: 16px; 
    border-radius: 30px; font-size: 18px; font-weight: bold; width: 100%; 
    text-align: center; cursor: pointer; margin-top: 10px;
  }
  .btn:active { transform: scale(0.95); }
  .btn-outline { background: transparent; border: 1px solid var(--neon-purple); color: #D8B4FE; }
  
  /* è¡¨å•è¾“å…¥æ¡† (æš—é»‘ç‰ˆ) */
  input[type="text"], input[type="tel"], input[type="file"], select {
    width: 100%; padding: 16px; border: 1px solid var(--border-glass); border-radius: 12px; 
    margin-bottom: 15px; background: rgba(0,0,0,0.2); font-size: 16px; color: #fff; outline: none;
    -webkit-appearance: none; appearance: none;
  }
  input::placeholder { color: #5B607A; }
  select:invalid { color: #5B607A; }
  select option { background: #13142B; color: #fff; }

  /* æµ‹è¯•ç­”é¢˜é€‰é¡¹ */
  .quiz-option { 
    background: rgba(255,255,255,0.05); border: 1px solid var(--border-glass); padding: 16px; border-radius: 12px;
    margin-bottom: 12px; font-size: 16px; text-align: center; cursor: pointer; color: #ccc; transition: 0.2s;
  }
  .quiz-option.selected { border-color: var(--neon-purple); background: rgba(178, 88, 255, 0.15); font-weight: bold; color: #fff; }
  
  /* å°chipé€‰é¡¹ (ç”¨äºè…¿çš„æ•°é‡) */
  .legs-option { padding: 12px; margin-bottom: 0; min-width: 70px; flex:1; }
  
  /* æµ·æŠ¥å±•ç¤º */
  #posterPreview { width: 100%; max-width: 300px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); display: block; margin: 0 auto; border: 1px solid var(--border-glass);}
  
  /* è¿”å›æŒ‰é’® */
  .back-btn { font-size: 14px; color: var(--text-sub); text-align: center; margin-top: 20px; text-decoration: underline; cursor:pointer;}
</style>
</head>
<body>

  <!-- ================= é¡µé¢ 01ï¼šä¸»èœå•é¡µ ================= -->
  <div id="page-main" class="page active">
    <div class="top-bar">
      <div class="brand">
        <img src="logo.png" style="height: 40px; width: 100px; border-radius: 8px; margin-right: 10px; object-fit: cover;">
      </div>
      <div class="share-btn">ğŸ”—</div>
    </div>

    <h1 class="neon-title">æ˜Ÿæ²™èŒå¨ƒ<br>æ°”è´¨å¤§èµ</h1>
    <p class="subtitle">å¯»è§…å…¨æ˜Ÿæ²™æœ€æœ‰èŒƒå„¿çš„å¼€å­¦é”¦é²¤</p>

    <!-- ç©æ³•å¡ç‰‡ 1 - äº²å­é»˜å¥‘æŒ‘æˆ˜ï¼ˆå·²å†…ç½®ä¸‰ä¸ªé—®é¢˜ï¼‰ -->
    <div class="menu-card" onclick="navTo('page-game1')">
      <div class="menu-icon" style="background: var(--icon-purple);">ğŸ¤</div>
      <div class="menu-text">
        <h3>äº²å­é»˜å¥‘æŒ‘æˆ˜</h3>
        <p>ä¸‰ä¸ªè„‘æ´é—®é¢˜ Â· æµ‹æµ‹é»˜å¥‘æŒ‡æ•°</p>
      </div>
      <div class="menu-arrow">â–¶</div>
    </div>

    <!-- ç©æ³•å¡ç‰‡ 2 - èŒå¨ƒè¡¨æƒ…å¤§èµï¼ˆæŠ½ç­¾äº”è¿ï¼‰ -->
    <div class="menu-card" onclick="navTo('page-game2')">
      <div class="menu-icon" style="background: var(--icon-pink);">ğŸ“¸</div>
      <div class="menu-text">
        <h3>èŒå¨ƒè¡¨æƒ…å¤§èµ</h3>
        <p>æŠ½ç­¾è§£é”æ˜¾çœ¼åŒ…æŒ‘æˆ˜</p>
      </div>
      <div class="menu-arrow">â–¶</div>
    </div>

    <!-- ç©æ³•å¡ç‰‡ 3 - å®¶é•¿æ°”è´¨è¯„æµ‹ï¼ˆä¸‰é—®ï¼‰ -->
    <div class="menu-card" onclick="navTo('page-game3')">
      <div class="menu-icon" style="background: var(--icon-blue);">ğŸ–ï¸</div>
      <div class="menu-text">
        <h3>å®¶é•¿æ°”è´¨è¯„æµ‹</h3>
        <p>ä¸‰é“é¢˜é‰´å®šç¡¬æ ¸çˆ¸å¦ˆ</p>
      </div>
      <div class="menu-arrow">â–¶</div>
    </div>

    <div class="footer-info">
      <div class="footer-time">æ´»åŠ¨æ—¶é—´ï¼š2026.02.23 - 2026.03.10</div>
      <div class="tags">
        <div class="tag">æ˜Ÿæ²™è¡—é“æˆæƒ</div>
        <div class="tag">å“ç‰Œè”åŠ¨æ”¯æŒ</div>
      </div>
    </div>
  </div>

  <!-- ================= ç©æ³•ä¸€ï¼šäº²å­é»˜å¥‘æŒ‘æˆ˜ (ä¸‰ä¸ªå¯ç©é—®é¢˜) ================= -->
  <div id="page-game1" class="page">
    <h2 style="margin: 30px 0 20px; font-size: 24px; text-align:center;">äº²å­é»˜å¥‘æŒ‘æˆ˜</h2>
    <div class="inner-card">
      <!-- Q1 -->
      <p style="color:var(--text-sub); margin-bottom:5px; font-size: 14px;">Q1: å¦‚æœå¦ˆå¦ˆæœ‰é­”æ³•ï¼Œç¬¬ä¸€ä»¶äº‹æƒ³å¸¦ä½ åšä»€ä¹ˆ?</p>
      <input type="text" id="g1a1" placeholder="æ¯”å¦‚ï¼šé£åˆ°äº‘æœµä¸Š" value="">

      <!-- Q2 å¸¦é€‰é¡¹ -->
      <p style="color:var(--text-sub); margin: 20px 0 5px; font-size: 14px;">Q2: ç»™å¦ˆå¦ˆç”»ä¸€å¼ åƒï¼Œä½ ä¼šç»™å¥¹ç”»å‡ æ¡è…¿?</p>
      <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:5px;">
        <div class="quiz-option legs-option" onclick="selectLegs(0, this)">0æ¡</div>
        <div class="quiz-option legs-option" onclick="selectLegs(2, this)">2æ¡</div>
        <div class="quiz-option legs-option" onclick="selectLegs(4, this)">4æ¡</div>
        <div class="quiz-option legs-option" onclick="selectLegs(8, this)">8æ¡</div>
      </div>
      <input type="hidden" id="g1a2" value="">

      <!-- Q3 -->
      <p style="color:var(--text-sub); margin: 20px 0 5px; font-size: 14px;">Q3: å¦‚æœæ˜Ÿæ˜Ÿå¯ä»¥åƒï¼Œä½ è§‰å¾—æ˜¯ä»€ä¹ˆå‘³é“?</p>
      <input type="text" id="g1a3" placeholder="æ¯”å¦‚ï¼šè‰è“å‘³è·³è·³ç³–">

      <!-- ä¸Šä¼ ç…§ç‰‡ -->
      <p style="color:var(--text-sub); margin: 20px 0 5px; font-size: 14px;">ä¸Šä¼ å®è´é“ç…§ï¼š</p>
      <input type="file" id="photo-input1" accept="image/*" capture="environment">
    </div>

    <button class="btn" onclick="generatePoster('game1')">ç”Ÿæˆé»˜å¥‘å†™çœŸæµ·æŠ¥</button>
    <div class="back-btn" onclick="navTo('page-main')">è¿”å›ä¸»é¡µ</div>
  </div>

  <!-- ================= ç©æ³•äºŒï¼šèŒå¨ƒè¡¨æƒ…å¤§èµ (ç‚¹å‡»æŠ½ç­¾ â†’ äº”é€‰ä¸€) ================= -->
  <div id="page-game2" class="page">
    <h2 style="margin: 30px 0 20px; font-size: 24px; text-align:center;">èŒå¨ƒè¡¨æƒ…å¤§èµ</h2>
    <div class="inner-card" style="text-align: center;">
      <div style="font-size: 40px; margin-bottom: 5px;">ğŸ­ æŠ½ç­¾æŒ‘æˆ˜</div>
      <button class="btn" style="padding:12px; font-size:16px; margin-bottom:20px; background:var(--icon-pink);" onclick="drawChallenge()">ğŸ² ç‚¹å‡»æŠ½ç­¾</button>
      
      <!-- æŠ½ç­¾ç»“æœå±•ç¤ºåŒº -->
      <div id="challengeDisplay" style="background:rgba(255,255,255,0.05); border-radius:16px; padding:20px; margin-bottom:20px; min-height:120px;">
        <p style="color:#ccc;">ğŸ‘† æŠ½ä¸€ä¸ªè¯•è¯•æ‰‹æ°”ï½</p>
      </div>

      <p style="color:var(--text-sub); margin-bottom:10px;">æŠ“æ‹å®è´æŒ‘æˆ˜ä¸­çš„è¡¨æƒ…/åŠ¨ä½œ</p>
      <input type="file" id="photo-input2" accept="image/*" capture="environment">
    </div>
    <button class="btn" style="background: var(--icon-pink);" onclick="generatePoster('game2')">ç”Ÿæˆè¡¨æƒ…åŒ…æµ·æŠ¥</button>
    <div class="back-btn" onclick="navTo('page-main')">è¿”å›ä¸»é¡µ</div>
  </div>

  <!-- ================= ç©æ³•ä¸‰ï¼šå®¶é•¿æ°”è´¨è¯„æµ‹ (ä¸‰ä¸ªé€‰æ‹©é¢˜) ================= -->
  <div id="page-game3" class="page">
    <h2 style="margin: 30px 0; font-size: 24px; text-align:center;">ç¡¬æ ¸å®¶é•¿è¯„æµ‹</h2>
    <div style="width:100%; text-align:right; color:var(--neon-purple); font-size:14px; margin-bottom:10px; font-weight:bold;">
      <span id="quiz-progress">1/3</span>
    </div>
    <div class="inner-card">
      <h3 id="quiz-q" style="margin-bottom:25px; font-size:18px; line-height:1.5; color: #fff;">é¢˜ç›®åŠ è½½ä¸­...</h3>
      <div id="quiz-options">
        <!-- é€‰é¡¹åŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>
    <div class="back-btn" onclick="navTo('page-main')">æ”¾å¼ƒç­”é¢˜ï¼Œè¿”å›ä¸»é¡µ</div>
  </div>

  <!-- ================= ç»“æœæµ·æŠ¥é¡µ ================= -->
  <div id="page-poster" class="page">
    <h2 style="margin: 30px 0 20px; font-size: 24px;">ç”ŸæˆæˆåŠŸ</h2>
    <img id="posterPreview" src="" alt="é•¿æŒ‰ä¿å­˜æµ·æŠ¥">
    <p style="color:var(--neon-purple); font-size: 14px; margin-top: 20px; font-weight: bold; text-align: center;">ğŸ‘‡ è¯·é•¿æŒ‰æµ·æŠ¥ä¿å­˜ï¼Œåˆ†äº«è‡³æœ‹å‹åœˆ</p>
    
    <div style="width: 100%; margin-top: 30px;">
      <button class="btn" onclick="navTo('page-form')">æˆ‘å·²åˆ†äº«æœ‹å‹åœˆï¼Œå»é¢†å¥– ğŸ</button>
      <button class="btn btn-outline" onclick="navTo('page-main')">è¿”å›é¦–é¡µ</button>
    </div>
  </div>

  <!-- ================= é˜²è–…ç¾Šæ¯›ï¼šä¿¡æ¯æäº¤é¡µ ================= -->
  <div id="page-form" class="page">
    <h2 style="margin: 30px 0 20px; font-size: 24px;">é”¦é²¤ç¤¼åŒ…ç™»è®°</h2>
    <p style="color:var(--text-sub); font-size:14px; margin-bottom:20px; text-align:center;">è¯·å®Œå–„ä¿¡æ¯ï¼Œæ–¹ä¾¿è€å¸ˆä¸ºæ‚¨æ ¸é”€å¥–å“</p>
    
    <div class="inner-card">
      <input type="text" id="form-name" placeholder="ğŸ‘¤ å®è´å§“å">
      <input type="tel" id="form-age" placeholder="ğŸ‚ å®è´å¹´é¾„">
      <input type="tel" id="form-phone" placeholder="ğŸ“± å®¶é•¿æ‰‹æœºå·">
      
      <div style="position: relative;">
        <select id="form-subject" required>
          <option value="" disabled selected hidden>ğŸ¨ è¯·é€‰æ‹©æ„Ÿå…´è¶£çš„ç§‘ç›®</option>
          <option value="å°‘å„¿ç¾æœ¯">å°‘å„¿ç¾æœ¯</option>
          <option value="å°‘å„¿å£æ‰">å°‘å„¿å£æ‰</option>
          <option value="å°‘å„¿èˆè¹ˆ">å°‘å„¿èˆè¹ˆ</option>
          <option value="ä¹¦æ³•">ä¹¦æ³•</option>
          <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
        <div style="position: absolute; right: 15px; top: 18px; color: #5B607A; pointer-events: none;">â–¼</div>
      </div>
      
      <button class="btn" onclick="submitForm()">æäº¤æ ¸é”€ä¿¡æ¯</button>
      
      <p style="color: #F87171; font-size: 12px; margin-top: 15px; text-align: center; line-height: 1.5;">
        âš ï¸ æäº¤åè¯·åŠ¡å¿…ä¿ç•™æœ‹å‹åœˆè®°å½•ï¼Œ<br>ç°åœºæ ¸é”€éœ€å‡ºç¤ºæ‰‹æœºæˆªå›¾å“¦ï¼
      </p>
    </div>
  </div>

  <!-- ================= æœ€ç»ˆé¡µï¼šå¯¼æµè‡³ä¼å¾® ================= -->
  <div id="page-finish" class="page">
    <div style="text-align: center; margin-top: 6vh;">
      <div style="font-size: 60px; margin-bottom: 20px;">ğŸ‰</div>
      <h2 style="font-size: 28px; margin-bottom: 10px;">ç™»è®°æˆåŠŸ</h2>
    </div>
    
    <div class="inner-card" style="text-align:center; margin-top: 20px;">
      <p style="font-size:16px; font-weight:bold; color:#fff; margin-bottom:20px;">æœ€åä¸€æ­¥ï¼šæ·»åŠ è€å¸ˆå¾®ä¿¡å‘æˆªå›¾</p>
      
      <div style="width:180px; height:180px; background:#fff; margin:0 auto; border-radius:16px; padding:10px;">
        <img src="qr.png" style="width:100%; height:100%; object-fit: contain;">
      </div>

      <p style="color:var(--neon-purple); font-size: 16px; font-weight:bold; margin-top: 20px;">é•¿æŒ‰è¯†åˆ«äºŒç»´ç æ·»åŠ è€å¸ˆ</p>
      <p style="color:var(--text-sub); font-size:14px; margin-top:10px; line-height:1.6;">
        å‘é€æš—å· <span style="color:#fff;">ã€æœ‹å‹åœˆæˆªå›¾ã€‘</span><br>
        å³åˆ»ä¸ºæ‚¨é”å®šå¤§ç¤¼åŒ…ï¼
      </p>
    </div>
  </div>

  <!-- éšè— Canvas -->
  <canvas id="posterCanvas" width="800" height="1200" style="display:none;"></canvas>

<script>
  // ================= å…¨å±€è·¯ç”± =================
  function navTo(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    window.scrollTo(0,0);
    if(pageId === 'page-game3') startQuiz();  // è¿›å…¥è¯„æµ‹é‡ç½®é¢˜ç›®
  }

  // ================= äº²å­é»˜å¥‘æŒ‘æˆ˜ï¼šQ2 é€‰é¡¹ =================
  function selectLegs(val, el) {
    document.getElementById('g1a2').value = val;
    // ç§»é™¤æ‰€æœ‰è…¿é€‰é¡¹çš„é«˜äº®
    document.querySelectorAll('.legs-option').forEach(opt => opt.classList.remove('selected'));
    el.classList.add('selected');
  }

  // ================= èŒå¨ƒè¡¨æƒ…å¤§èµï¼šæŠ½ç­¾æ•°æ® =================
  const challenges = [
    { title: "å¤§çŒ©çŒ©æ¶èƒ¸", desc: "ä¸€è¾¹æ¶èƒ¸ä¸€è¾¹å‘å‡º'å‘œå‘œ'å£°ï¼Œè¶Šå‡¶è¶Šå¥½ç¬‘!" },
    { title: "å°å¤©é¹…é£é£", desc: "è¸®èµ·è„šå°–ï¼ŒåŒæ‰‹åšç¿…è†€ï¼Œä¼˜é›…ä¸­å¸¦ç‚¹æç¬‘" },
    { title: "ä¼é¹…æ‘‡æ‘‡æ™ƒæ™ƒ", desc: "ä¸¤æ‰‹è´´ç´§èº«ä½“ï¼Œå·¦å³æ‘‡æ‘†èµ°ï¼Œæœ€å¥½æ’åˆ°å¦ˆå¦ˆæ€€é‡Œ" },
    { title: "å°èƒèŸ¹æ¨ªç€èµ°", desc: "æ¨ªç€èµ°ï¼Œä¸¤åªæ‰‹åšé’³å­" },
    { title: "è¡¨æƒ…åŒ…äº”è¿æ‹", desc: "10ç§’å†…åš5ä¸ªè¡¨æƒ…ï¼šå¼€å¿ƒ-ç”Ÿæ°”-æƒŠè®¶-å§”å±ˆ-å‘å‘†-å¾—æ„-å›°äº†-åƒé¥±äº†-çœ‹è§å†°æ·‡æ·‹" }
  ];
  let currentChallenge = null; // å­˜å‚¨å½“å‰æŠ½ä¸­çš„æŒ‘æˆ˜

  function drawChallenge() {
    const randomIndex = Math.floor(Math.random() * challenges.length);
    currentChallenge = challenges[randomIndex];
    const displayDiv = document.getElementById('challengeDisplay');
    displayDiv.innerHTML = `
      <p style="color: var(--neon-purple); font-size: 22px; font-weight:bold; margin-bottom:5px;">${currentChallenge.title}</p>
      <p style="color: #fff; font-size: 15px; line-height:1.5;">${currentChallenge.desc}</p>
    `;
  }

  // ================= æµ·æŠ¥ç”Ÿæˆå¼•æ“ =================
  function generatePoster(gameType) {
    let fileInput, quoteText = "";
    if (gameType === 'game1') {
      fileInput = document.getElementById('photo-input1').files[0];
      const q1 = document.getElementById('g1a1').value.trim() || "æ²¡æƒ³å¥½";
      const q2 = document.getElementById('g1a2').value;
      const q3 = document.getElementById('g1a3').value.trim() || "ç§˜å¯†";
      const legsText = q2 ? q2 + "æ¡è…¿" : "æœªçŸ¥å‡ æ¡è…¿";
      if (!q2) { alert("è¯·ç»™å¦ˆå¦ˆé€‰å‡ æ¡è…¿ï½"); return; }
      quoteText = `âœ¨é­”æ³•:${q1} | ç”»åƒ:${legsText} | æ˜Ÿæ˜Ÿå‘³:${q3}`;
    } else if (gameType === 'game2') {
      fileInput = document.getElementById('photo-input2').files[0];
      if (!currentChallenge) { alert("è¯·å…ˆç‚¹å‡»æŠ½ç­¾ï¼ŒæŠ½å–ä¸€ä¸ªæŒ‘æˆ˜å§ï¼"); return; }
      quoteText = `${currentChallenge.title} Â· ${currentChallenge.desc}`;
    } else {
      // game3 å·²åœ¨ç‹¬ç«‹å‡½æ•°ç”Ÿæˆç»“æœï¼Œä¸è¿›è¿™é‡Œ
      return;
    }

    if (!fileInput) { alert("è¯·å…ˆä¸Šä¼ ä¸€å¼ ç…§ç‰‡å“¦ï¼"); return; }

    const reader = new FileReader();
    reader.onload = function(e) {
      const canvas = document.getElementById('posterCanvas');
      const ctx = canvas.getContext('2d');
      
      // æš—é»‘æ¸å˜èƒŒæ™¯
      const grad = ctx.createLinearGradient(0,0,0,1200);
      grad.addColorStop(0, '#1A1C35'); grad.addColorStop(1, '#0C0E1F');
      ctx.fillStyle = grad; ctx.fillRect(0,0,800,1200);

      const img = new Image();
      img.src = e.target.result;
      img.onload = () => {
        // ç›¸æ¡†å¤–å‘å…‰
        ctx.shadowColor = '#B258FF'; ctx.shadowBlur = 30;
        ctx.fillStyle = '#fff'; 
        ctx.beginPath(); ctx.roundRect(80, 200, 640, 640, 40); ctx.fill();
        ctx.shadowBlur = 0;

        // ç»˜åˆ¶ç…§ç‰‡ (å±…ä¸­è£å‰ª)
        ctx.save();
        ctx.beginPath(); ctx.roundRect(80, 200, 640, 640, 40); ctx.clip();
        let scale = Math.max(640 / img.width, 640 / img.height);
        let sw = 640 / scale, sh = 640 / scale;
        let sx = (img.width - sw) / 2, sy = (img.height - sh) / 2;
        ctx.drawImage(img, sx, sy, sw, sh, 80, 200, 640, 640);
        ctx.restore();

        // æ ‡é¢˜
        ctx.fillStyle = "#fff"; 
        ctx.font = "bold 56px 'PingFang SC', sans-serif"; 
        ctx.textAlign = "center";
        ctx.fillText(gameType === 'game1' ? "æ˜Ÿæ²™èŒå¨ƒå†™çœŸ" : "æ˜Ÿæ²™æ˜¾çœ¼åŒ…å¤§èµ", 400, 130);

        // åº•éƒ¨æ–‡å­—å¡ç‰‡
        ctx.fillStyle = "rgba(255,255,255,0.1)";
        ctx.beginPath(); ctx.roundRect(80, 900, 640, 180, 20); ctx.fill();

        // æ ¹æ®quoteTexté•¿åº¦è°ƒæ•´å­—ä½“å¤§å°
        ctx.fillStyle = "#D8B4FE";
        let fontSize = 30;
        if (quoteText.length > 30) fontSize = 26;
        else if (quoteText.length > 20) fontSize = 28;
        ctx.font = `bold ${fontSize}px 'PingFang SC', sans-serif`;

        // æ‰‹åŠ¨æ¢è¡Œå¤„ç† (ç®€å•åˆ‡åˆ†)
        const maxWidth = 580;
        let words = quoteText;
        let lines = [];
        let line = '';
        for (let n = 0; n < words.length; n++) {
            let testLine = line + words[n];
            let metrics = ctx.measureText(testLine);
            if (metrics.width > maxWidth && n > 0) {
                lines.push(line);
                line = words[n];
            } else {
                line = testLine;
            }
        }
        lines.push(line);
        // æœ€å¤šæ˜¾ç¤ºä¸¤è¡Œ
        let startY = 950;
        for (let i = 0; i < Math.min(lines.length, 2); i++) {
            ctx.fillText(lines[i], 400, startY + i * 42);
        }
        
        ctx.fillStyle = "#8E93A8"; 
        ctx.font = "24px 'PingFang SC', sans-serif";
        ctx.fillText("â€”â€” æ˜Ÿæ²™ 2026 å®˜æ–¹è®¤è¯", 400, 1050);
        
        document.getElementById('posterPreview').src = canvas.toDataURL('image/jpeg');
        navTo('page-poster');
      }
    }
    reader.readAsDataURL(fileInput);
  }

  // ================= ç©æ³•ä¸‰ï¼šå®¶é•¿æ°”è´¨è¯„æµ‹ =================
  const quizData = [
    { q: "å‘¨æœ«å¸¦å­©å­å‡ºå»ç©ï¼Œä½ é€šå¸¸ä¼šï¼Ÿ", options: [{t:"åšè¯¦ç»†æ”»ç•¥ï¼ŒæŒ‰è®¡åˆ’èµ°", s:"A"}, {t:"éšå«éšèµ°ï¼Œä¸»æ‰“ä¸€ä¸ªéšæ€§", s:"B"}, {t:"ç»™å¨ƒæŠ¥ä¸ªä½“éªŒè¯¾ï¼Œæˆ‘åœ¨æ—è¾¹å–å’–å•¡", s:"C"}] },
    { q: "å­©å­å¼„è„äº†åˆšä¹°çš„æ–°è¡£æœï¼Œä½ çš„ååº”ï¼Ÿ", options: [{t:"å´©æºƒï¼é©¬ä¸Šè„±ä¸‹æ¥æ´—", s:"A"}, {t:"èµ¶ç´§æ‹ç…§å‘æœ‹å‹åœˆ", s:"B"}, {t:"è„å°±è„å§ï¼Œç©å¾—å¼€å¿ƒæœ€é‡è¦", s:"C"}] },
    { q: "ç»™å­©å­è¾…å¯¼ä½œä¸šæ—¶ï¼Œä½ çš„çŠ¶æ€æ˜¯ï¼Ÿ", options: [{t:"æ¯æ…ˆå­å­ï¼Œè€å¿ƒè®²è§£", s:"A"}, {t:"é¸¡é£ç‹—è·³ï¼Œéšæ—¶çˆ†å‘", s:"B"}, {t:"ç›´æ¥äº¤ç»™çˆ¸çˆ¸/è¾…å¯¼ç­", s:"C"}] }
  ];
  let currentQuiz = 0; let scores = { A:0, B:0, C:0 };

  function startQuiz() {
    currentQuiz = 0; scores = {A:0, B:0, C:0};
    renderQuiz();
  }

  function renderQuiz() {
    document.getElementById('quiz-progress').innerText = `${currentQuiz + 1} / 3`;
    document.getElementById('quiz-q').innerText = quizData[currentQuiz].q;
    let optsHtml = "";
    quizData[currentQuiz].options.forEach((opt) => {
      optsHtml += `<div class="quiz-option" onclick="selectOption('${opt.s}')">${opt.t}</div>`;
    });
    document.getElementById('quiz-options').innerHTML = optsHtml;
  }

  function selectOption(scoreType) {
    scores[scoreType]++;
    setTimeout(() => {
      if(currentQuiz < 2) { currentQuiz++; renderQuiz(); } 
      else { generateQuizResult(); }
    }, 200);
  }

  function generateQuizResult() {
    let max = 'A';
    if(scores.B > scores[max]) max = 'B';
    if(scores.C > scores[max]) max = 'C';
    let res = max === 'A' ? "å…¨èƒ½æ“å¿ƒå‹è€å¦ˆ" : max === 'B' ? "å¿«ä¹æ”¾å…»å‹ç¡¬æ ¸çˆ¸å¦ˆ" : "ä½›ç³»èººå¹³å‹å®¶é•¿";

    const canvas = document.getElementById('posterCanvas');
    const ctx = canvas.getContext('2d');
    ctx.fillStyle = '#1A1C35'; ctx.fillRect(0,0,800,1200);
    
    ctx.fillStyle = '#fff'; ctx.font = "bold 60px sans-serif"; ctx.textAlign = "center";
    ctx.fillText("ç¡¬æ ¸å®¶é•¿é‰´å®šæŠ¥å‘Š", 400, 300);
    ctx.fillStyle = "#B258FF"; ctx.font = "bold 70px sans-serif";
    ctx.fillText(res, 400, 600);
    
    document.getElementById('posterPreview').src = canvas.toDataURL('image/jpeg');
    navTo('page-poster');
  }

  // ================= æäº¤è¡¨å• =================
  function submitForm() {
    const name = document.getElementById('form-name').value.trim();
    const age = document.getElementById('form-age').value.trim();
    const phone = document.getElementById('form-phone').value.trim();
    const subject = document.getElementById('form-subject').value;

    if(!name) { alert("è¯·å¡«å†™å®è´å§“åå“¦~"); return; }
    if(!age) { alert("è¯·å¡«å†™å®è´å¹´é¾„å“¦~"); return; }
    if(!phone || phone.length < 11) { alert("è¯·å¡«å†™æ­£ç¡®çš„å®¶é•¿æ‰‹æœºå·å“¦~"); return; }
    if(!subject) { alert("è¯·é€‰æ‹©æ„Ÿå…´è¶£çš„ç§‘ç›®~"); return; }

    // ç›´æ¥è·³è½¬åˆ°ä¼ä¸šå¾®ä¿¡å¼•å¯¼é¡µ
    navTo('page-finish');
  }

  // ç”»åœ†è§’çŸ©å½¢è¾…åŠ©
  CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
    if (w < 2 * r) r = w / 2;
    if (h < 2 * r) r = h / 2;
    this.moveTo(x + r, y);
    this.lineTo(x + w - r, y);
    this.quadraticCurveTo(x + w, y, x + w, y + r);
    this.lineTo(x + w, y + h - r);
    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
    this.lineTo(x + r, y + h);
    this.quadraticCurveTo(x, y + h, x, y + h - r);
    this.lineTo(x, y + r);
    this.quadraticCurveTo(x, y, x + r, y);
    this.closePath();
    return this;
  };
</script>
</body>
</html>