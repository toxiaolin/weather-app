<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">

<title>èŒå¨ƒæ°”è´¨å¤§èµ</title>

<style>
body{
  margin:0;
  background:#fff7ef;
  font-family:sans-serif;
  text-align:center;
}

video{
  width:100%;
  max-height:60vh;
  object-fit:cover;
  background:#000;
}

#question{
  font-size:20px;
  padding:15px;
  color:#ff7f00;
  font-weight:bold;
}

button{
  background:#ff7f00;
  color:white;
  border:none;
  padding:14px 24px;
  font-size:18px;
  border-radius:10px;
  margin:10px;
}

#posterImage{
  width:100%;
  display:none;
  margin-top:15px;
}
</style>
</head>

<body>

<video id="camera" autoplay playsinline></video>

<div id="question">
å½“å‰é¢˜ç›®ï¼šæœ€èŒçš„ä¸€å¥å£å¤´ç¦…ï¼Ÿ
</div>

<button id="photoBtn">ğŸ“¸ æ‹ç…§ç”Ÿæˆæµ·æŠ¥</button>

<canvas id="posterCanvas" width="600" height="800" style="display:none;"></canvas>

<img id="posterImage"/>

<script src="poster.js"></script>

<script>
async function initCamera() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{ facingMode:"environment" },
      audio:false
    });
    camera.srcObject = stream;
  } catch(e){
    alert("æ— æ³•æ‰“å¼€æ‘„åƒå¤´ï¼Œè¯·å…è®¸æƒé™");
  }
}

initCamera();

photoBtn.onclick = () => {

  const video = document.getElementById("camera");

  const tempCanvas = document.createElement("canvas");
  tempCanvas.width = video.videoWidth;
  tempCanvas.height = video.videoHeight;

  tempCanvas.getContext("2d")
    .drawImage(video,0,0);

  const photo = tempCanvas.toDataURL("image/jpeg");

  drawPoster("posterCanvas",{
      avatar:photo,
      title:"èŒå¨ƒé‡‘å¥",
      logo:"logo.png",
      qr:"qr.png"
  },(url)=>{
      posterImage.src = url;
      posterImage.style.display="block";
      window.scrollTo(0,document.body.scrollHeight);
  });
};
</script>

</body>
</html>